task_id,title,description,priority,status,phase,estimated_effort,dependencies,branch_name,pr_template,test_file,notes
TASK-20250929-001,"Decompose main.py monolith - Extract authentication routes","Extract authentication-related routes from main.py (2,273 lines) to app/routes/auth.py. Move login, register, logout routes while maintaining existing API contracts. Create app/routes/__init__.py and app/dependencies/auth.py structure. Ensure all existing tests pass without modification. Target: Reduce main.py by ~300 lines. Acceptance Criteria: 1) All auth routes moved to auth.py 2) No API contract changes 3) All tests pass 4) Authentication flow unchanged.",critical,completed,1,2,none,refactor/auth-routes-20250929,critical-refactoring.md,tests/test_routes_refactor_scaffold.py,"✅ DEPLOYED TO PRODUCTION (Sept 30, 2025 23:40 UTC). Auth routes extracted (275 lines auth.py, 102 lines auth dependencies). 8 auth routes registered (/login, /register, /web/login, /web/register, /web/logout, /auth/login, /auth/register, /auth/me). Rebased on TASK-003 for all fixes (bcrypt 4.1.3, Docker, templates config). Tested in test env (port 8001), deployed to production http://159.65.174.94:8000. 95 total routes. Zero downtime. Authentication fully functional."
TASK-20250929-002,"Decompose main.py monolith - Extract quote routes","Extract quote-related routes from main.py to app/routes/quotes.py. Move quote CRUD operations, calculate endpoint, and quote list page. Preserve quote calculation engine functionality. Target: Reduce main.py by ~500 lines. Acceptance Criteria: 1) All quote routes moved to quotes.py 2) Quote calculations work identically 3) CSV export/import preserved 4) Quote editing (QE-001) functional.",critical,completed,1,2,TASK-20250929-001,refactor/quote-routes-20250929,critical-refactoring.md,tests/test_routes_refactor_scaffold.py,"Router created (659 lines with 10 routes + 2 calc functions). Registered in main.py. Rebased with main (includes TASK-001 and TASK-003). Ready for deployment."
TASK-20250929-003,"Decompose main.py monolith - Extract work order and material routes","Extract work order routes (QTO-001 system) to app/routes/work_orders.py and material management routes to app/routes/materials.py. Move WorkOrder CRUD operations, materials catalog, and CSV upload endpoints. Target: Reduce main.py to <500 lines. Acceptance Criteria: 1) Work order routes in work_orders.py 2) Material routes in materials.py 3) QTO-001 functionality preserved 4) Material CSV upload working 5) main.py contains only app initialization.",critical,completed,1,2,TASK-20250929-002,refactor/workorder-material-routes-20250929,critical-refactoring.md,tests/test_routes_refactor_scaffold.py,"✅ DEPLOYED TO PRODUCTION (Sept 30, 2025 22:15 UTC). Routers created (335+517 lines), tested in test env, all issues fixed, deployed to http://159.65.174.94:8000. 95 routes registered (25 materials, 15 work orders). Zero downtime deployment. Duplicates remain in main.py for TASK-012 cleanup."
TASK-20250929-004,"Fix CSV test script extreme complexity","Refactor run_csv_tests.py to reduce cyclomatic complexity from E rating (31) to <10. Extract test case generators to separate functions. Implement test builder pattern for CSV test scenarios. Break down monolithic test function into focused unit tests. Acceptance Criteria: 1) Cyclomatic complexity <10 2) Test coverage maintained 3) All CSV tests pass 4) Code follows pytest best practices 5) Test execution time unchanged or improved.",high,pending,1,1,none,refactor/csv-tests-complexity-20250929,critical-refactoring.md,tests/test_routes_refactor_scaffold.py,
TASK-20250929-005,"Implement service interfaces for dependency inversion","Create abstract base classes for database services to implement Dependency Inversion Principle. Add IUserService, IQuoteService, IWorkOrderService, IMaterialService interfaces in app/interfaces/. Update existing service classes to implement interfaces. Enable better testing with mock implementations. Acceptance Criteria: 1) Abstract base classes created 2) All services implement interfaces 3) Services depend on abstractions not concretions 4) Mock service implementations for testing 5) No functionality changes.",high,pending,1,2,TASK-20250929-003,refactor/service-interfaces-20250929,critical-refactoring.md,tests/test_architecture_patterns_scaffold.py,
TASK-20250929-006,"Optimize database queries in BOM calculations","Fix N+1 query problem in calculate_window_item_from_bom function (main.py:533-650). Implement eager loading for BOM relationships using SQLAlchemy joinedload(). Add query batching for material lookups. Target: Reduce database queries by 80%, improve quote calculation from 200ms to 50ms. Acceptance Criteria: 1) N+1 queries eliminated 2) Performance improvement measured with pytest-benchmark 3) Quote calculation <100ms for typical BOM 4) Database query count reduced by 80% 5) No functionality changes.",high,pending,2,2,TASK-20250929-003,perf/bom-query-optimization-20250929,performance-optimization.md,tests/test_performance_optimization_scaffold.py,
TASK-20250929-007,"Implement formula evaluation caching","Add LRU cache for SafeFormulaEvaluator parsed expressions. Cache simpleeval expression parsing to avoid repeated parsing overhead. Implement functools.lru_cache with maxsize=128 for frequently used formulas. Target: Reduce formula evaluation overhead by 60%. Acceptance Criteria: 1) LRU cache implemented for expression parsing 2) Cache hit rate >70% for typical usage 3) Performance improvement measured 4) Memory usage acceptable (<50MB cache) 5) Cache invalidation on formula changes.",medium,pending,2,1,TASK-20250929-006,perf/formula-caching-20250929,performance-optimization.md,tests/test_performance_optimization_scaffold.py,
TASK-20250929-008,"Implement streaming CSV processing","Replace memory-intensive CSV loading in MaterialCSVService with streaming approach. Implement chunked processing for large CSV files using pandas chunksize parameter or csv.reader iteration. Support CSV files up to 100MB (currently limited to ~10MB). Reduce memory usage for CSV operations. Acceptance Criteria: 1) Streaming CSV reader implemented 2) Support files up to 100MB 3) Memory usage <200MB for 100MB file 4) Processing time linear with file size 5) All CSV import/export tests pass.",medium,pending,2,2,TASK-20250929-004,perf/csv-streaming-20250929,performance-optimization.md,tests/test_performance_optimization_scaffold.py,
TASK-20250929-009,"Implement command pattern for quote calculations","Create CalculateQuoteCommand class implementing command pattern for quote calculation operations. Enable undo/redo functionality for quote modifications. Improve testability by encapsulating calculation logic. Add QuoteCommandInvoker for command execution. Acceptance Criteria: 1) CalculateQuoteCommand class created 2) Command pattern properly implemented 3) Undo capability added 4) Calculation logic encapsulated 5) Unit tests for command execution.",medium,pending,3,2,TASK-20250929-006,arch/quote-command-pattern-20250929,architecture-improvement.md,tests/test_architecture_patterns_scaffold.py,
TASK-20250929-010,"Extract business logic from Jinja2 templates","Move calculation logic from HTML templates to service layer. Create template helper functions in services/template_helpers.py. Extract data processing from templates/quotes_list.html, templates/view_quote.html, templates/work_order_detail.html. Improve separation of concerns following Single Responsibility Principle. Acceptance Criteria: 1) No calculations in templates 2) Template helpers created 3) Templates use pre-processed data only 4) All pages render correctly 5) No visual changes to UI.",low,pending,3,1,TASK-20250929-009,arch/template-logic-extraction-20250929,architecture-improvement.md,tests/test_architecture_patterns_scaffold.py,
TASK-20250929-011,"Implement factory pattern for model creation","Create MaterialFactory and ProductFactory classes for model instantiation. Simplify object creation with validation and default values. Add factories in app/factories/ directory. Enable consistent object creation across application. Acceptance Criteria: 1) MaterialFactory class created 2) ProductFactory class created 3) Factories handle validation 4) Default values properly set 5) Existing code migrated to use factories.",low,pending,3,1,TASK-20250929-010,arch/model-factories-20250929,architecture-improvement.md,tests/test_architecture_patterns_scaffold.py,
TASK-20250929-012,"Remove duplicate auth and quote routes from main.py","Clean up main.py by removing duplicate auth routes (lines 724-901) and quote routes (lines 903-1400) now that routers are registered and working. Verify no functionality breaks. Target: Reduce main.py by ~670 lines. Acceptance Criteria: 1) All duplicate auth routes removed 2) All duplicate quote routes removed 3) All tests still pass 4) Application starts successfully 5) No broken imports or references.",medium,completed,1,0.5,TASK-20250929-002,refactor/cleanup-duplicate-routes-20250929,critical-refactoring.md,tests/test_routes_refactor_scaffold.py,"✅ COMPLETED (Oct 2, 2025) - Removed 9 duplicate quote routes from main.py (418 lines). Auth routes already clean. Reduced main.py from 1,979 to 1,561 lines (-21%). Route count: 104 → 95. All tests passing. Branch: refactor/cleanup-duplicate-routes-20250929. Commits: 008f617 (code), 1189df4 (tests)."
HOTFIX-20251001-001,"Fix Router Data Processing (QuoteListPresenter)","Extract 85-line data processing logic from main.py to QuoteListPresenter class in app/presenters/. Router was returning raw Quote objects but template expected processed data with calculated fields (total_area, price_per_m2, items_count, sample_items). This caused 500 errors on quotes list page. Router temporarily disabled in production. Acceptance Criteria: 1) QuoteListPresenter class created 2) Router uses presenter to process quotes 3) Template receives processed data 4) All quote routes working 5) Router re-enabled 6) Duplicate main.py route removed 7) Tested and deployed to production.",critical,completed,0,1,none,hotfix/router-data-processing-20251001,critical-refactoring.md,tests/test_integration_quotes_routes.py,"✅ DEPLOYED TO PRODUCTION (Oct 1, 2025 21:30 UTC). Created app/presenters/quote_presenter.py with QuoteListPresenter class. Extracted all data processing logic (85 lines). Router re-enabled, duplicate route removed, tested in test env (port 8001), deployed to production http://159.65.174.94:8000. Zero downtime. All quote routes working with presenter pattern. Fixes HOTFIX-20251001-RCA.md findings."
HOTFIX-20251001-002,"Add Integration Tests for Quote Routes","Add comprehensive integration tests for template rendering and router compatibility to prevent future HOTFIX-20251001-001 type bugs. Test quotes list page rendering, pagination, template data compatibility, database service offset parameter, and QuoteListPresenter integration. Create tests/test_integration_quotes_routes.py with mock-based testing approach using real QuoteListPresenter. Acceptance Criteria: 1) Test quotes list page renders successfully 2) Test pagination works correctly 3) Test template data compatibility 4) Test database service offset parameter 5) Comprehensive coverage of quotes list route.",high,completed,0,1,HOTFIX-20251001-001,test/quote-routes-integration-20251001,critical-refactoring.md,tests/test_integration_quotes_routes.py,"✅ COMPLETE - PR #7 (Oct 1, 2025 22:00 UTC). Created 13 integration tests (690 lines) covering: empty state, single quote, pagination (25 quotes), presenter calculated fields, database pagination parameters. All tests passing (13/13). Coverage: 70% presenter, 23% routes, 50% database. Mock-based testing with real QuoteListPresenter. SQLite test environment. No production code modified. Branch: test/quote-routes-integration-20251001."
DEVOPS-20251001-001,"Docker Build Process Improvements","Implement comprehensive Docker build improvements to prevent Python bytecode cache issues that caused 6+ rebuild attempts during HOTFIX-20251001-001. Add Python cache clearing in Dockerfile, build verification step, automated deployment scripts with verification, and comprehensive deployment runbook. Create network isolation prevention tools based on test environment deployment issues. Acceptance Criteria: 1) Python .pyc cache clearing in Dockerfile 2) Build verification confirms code changes 3) Automated deployment scripts (production + test) 4) Health check improvements 5) Deployment documentation 6) Network prevention tools 7) Test and production deployment successful.",critical,completed,0,2,none,devops/docker-build-improvements-20251001,deployment-improvements.md,none,"✅ DEPLOYED TO PRODUCTION (Oct 3, 2025 16:21 UTC). Added Python cache clearing + build verification to Dockerfile (19 lines). Created deploy-production.sh and deploy-test.sh scripts. Updated health checks in docker-compose.beta.yml. Created DEPLOYMENT-RUNBOOK.md (216 lines). Built prevention tools: pre-deploy-check.sh (183 lines), NETWORK-PREVENTION-GUIDE.md (356 lines), PRODUCTION-DEPLOYMENT-PLAN.md (283 lines). Deployed to test env (port 8001) - fixed network isolation issue (4 attempts). Deployed to production (port 8000) - zero network issues (as predicted). Both environments operational. 95 routes registered, Python cache cleared, build verification working. PR #10 merged. Branch: devops/docker-build-improvements-20251001."